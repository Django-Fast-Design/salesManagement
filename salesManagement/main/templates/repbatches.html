{%extends 'base.html'%}

<!DOCTYPE html>
<html lang="en">
<head>    {%block head%}

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Batches</title>    {%endblock%}

</head>
<body>
        {%block body%}
  <div class="container">
          <h3>Batches Report</h3>

    <div class="row">
      <div class="col-sm-12">
        <table id="table" class="table table-striped table-bordered" style="width:100%" data-server-side="true" data-ajax="/api/batchVS/?format=datatables">
          <thead>
            <tr>
              <th data-data="product_type">Product Type</th>
              <th data-data="unit_price">Unit Price</th>
              <th data-data="quant">Quantity</th>
              <th data-data="batchid">Batch ID</th>
              <th data-data="total_cost">Stock Cost</th>
              <th data-data="minselling">Min selling price</th>
            </tr>
          </thead>
        </table>
      </div>
    </div>
  </div>
  {%load static%}
  <script src="{% static "js/jquery-1.12.4.js" %}"></script>
  {%load static%}
  <script src="{% static "js/jquery.dataTables.min.js" %}"></script>
  {%load static%}
  <script src="{% static "js/dataTables.bootstrap4.min.js" %}"></script>
  <script>
      $(document).ready(function() {
              $('#table').DataTable( {
        "footerCallback": function ( row, data, start, end, display ) {
            var api = this.api(), data;
            // Remove the formatting to get integer data for summation
            var intVal = function ( i ) {
                return typeof i === 'string' ?
                    i.replace(/[\$,]/g, '')*1 :
                    typeof i === 'number' ?
                        i : 0;
            };
            var coltosum=[2,1]
            for (c in coltosum){
            coltosum[c]// Total over all pages
            total = api.column( coltosum[c] ).data().reduce( function (a, b) {return intVal(a) + intVal(b);}, 0 );
            // Total over this page
            pageTotal = api.column( coltosum[c], { page: 'current'} ).data().reduce( function (a, b) {return intVal(a) + intVal(b);}, 0 );
            // Update footer
            $( api.column( coltosum[c] ).footer() ).html(+pageTotal +' ( '+ total +' total )');}
        }
    } );});
         
  </script>

    
    {%endblock%}
</body>
</html>